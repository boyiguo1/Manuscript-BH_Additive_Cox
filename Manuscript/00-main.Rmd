---
title: A scalable and flexible Cox proportional hazards model for high-dimensional survival prediction and functional selection
authors:
- name: Boyi Guo
  thanks: Corresponding authors \\email{boyiguo1@uab.edu}
  department: Department of Biostatistics
  affiliation: University of Alabama at Birmingham
  location: Birmingham, AL
# - name: Byron C. Jaeger
#   department: Department of Biostatistics and Data Science
#   affiliation: Wake Forest School of Medicine
#   location: Winston-Salem, NC
# - name: AKM Fazlur Rahman
#   department: Department of Biostatistics
#   affiliation: University of Alabama at Birmingham
#   location: Birmingham, AL  
# - name: D. Leann Long
#   department: Department of Biostatistics
#   affiliation: University of Alabama at Birmingham
#   location: Birmingham, AL 
- name: Nengjun Yi
  thanks: Corresponding authors \\email{nyi@uab.edu}
  department: Department of Biostatistics
  affiliation: University of Alabama at Birmingham
  location: Birmingham, AL
abstract: "Cox proportional hazards (PH) model is one of the most popular models in biomedical data analysis. There have been continuing efforts to improve the flexibility of such models for complex signal detection, for example, via spline functions. Nevertheless, it is nontrivial to extend to the high-dimensional setting (p>>n). When estimating spline functions, commonly used grouped sparse regularization may induce excess shrinkage, damaging the predictive performance. Moreover, the previous “all-in-all-out” strategy for functional selection fails to answer if nonlinear components exist. We develop an additive Cox PH model that employs a novel spike-and-slab LASSO prior to select the linear and nonlinear components of spline functions. A scalable and deterministic algorithm, EM-Coordinate Descent, is designed for efficient model fitting. We compare the predictive and computational performance against the state-of-the-art models via Monte Carlo studies and metabolomics data analysis. The proposed model is broadly applicable to various research fields, e.g., genomics and population health, via the freely available R package BHAM (https://boyiguo1.github.io/BHAM/)"
keywords: Cox Model; Spike-and-Slab; Scalable; Machine Learning; Additive Models;
output: 
  rticles::arxiv_article:
    keep_tex: true
    #citation_package: biblatex
#biblio-style: apa
bibliography: "references.bib"
header-includes: 
    - \usepackage{amsmath}
---
\newcommand{\pr}{\text{Pr}}
\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\tp}{*}
\newcommand{\simiid}{\overset{\text{iid}}{\sim}}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(targets)
library(xtable)

tar_load(manu_path)
tar_load(manu_tabs)
tar_load(manu_figs)

```


```{r intro, child = "~/GitHub/Manuscript-BH_Additive_Cox/Manuscript/01-intro.Rmd"}
```

```{r method, child = "~/GitHub/Manuscript-BH_Additive_Cox/Manuscript/02-method.Rmd"}
```

```{r simulation, child="~/GitHub/Manuscript-BH_Additive_Cox/Manuscript/03-simulation.Rmd"}
```

```{r real_data, child="~/GitHub/Manuscript-BH_Additive_Cox/Manuscript/04-real_data.Rmd"}
```

```{r conclusion, child="~/GitHub/Manuscript-BH_Additive_Cox/Manuscript/05-conclusion.Rmd"}
```
\clearpage
\input{Tabs/sim_cnr_prop.tex}
\clearpage
\begin{figure}[h] 
\includegraphics{Figs/sim_cindex.pdf}
\caption{C-indices of out-of-sample prediction of 50 iterations of simulation studies. The models of comparison include the proposed Bayesian hierarchical additive model (BHAM), component selection and smoothing operator (COSSO), adaptive COSSO, and gcv. mgcv doesn't provide estimation whe number of parameters exceeds sample size i.e. p = 100, 200.}
\label{fig:sim_cindex}
\end{figure}

\clearpage

\begin{figure}[h] 
\includegraphics{Figs/ECB_bcam_KM}
\caption{The Kaplan-Meier estimates to show the predictive performacne of the proposed model, including the estimates for the predicted high risk group (blue), predicted low risk group (green), and overall group (red)}
\label{fig:ECB_bcam_KM}
\end{figure}

\clearpage

